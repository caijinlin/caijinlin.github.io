(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{290:function(t,a,e){"use strict";e.r(a);var v=e(14),_=Object(v.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"linux"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#linux"}},[t._v("#")]),t._v(" Linux")]),t._v(" "),a("h2",{attrs:{id:"文本处理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文本处理"}},[t._v("#")]),t._v(" 文本处理")]),t._v(" "),a("h3",{attrs:{id:"awk"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#awk"}},[t._v("#")]),t._v(" awk")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("cat <file> | awk -F ',' 'BEGIN{print \"字段1\",\"字段2\"} { print }'")]),t._v(" 输出表头")]),t._v(" "),a("li",[a("code",[t._v("cat <file> | awk -F ',' '{OFS=\",\"; print $2,$1,0}")]),t._v(" 每一行逗号拼接字符串")]),t._v(" "),a("li",[a("code",[t._v('cat <file> | awk \'BEGIN{ORS=","}{ print }')]),t._v(" 逗号连接多行")]),t._v(" "),a("li",[a("code",[t._v('cat <file> | awk \'BEGIN{RS=","}{ print }')]),t._v("  逗号分隔字符串")]),t._v(" "),a("li",[a("code",[t._v("cat <file> | awk -F ',' '{ print NR, NF }'")]),t._v(" 查看行数、列数")]),t._v(" "),a("li",[a("code",[t._v("cat <file> | awk -F ',' '{count[$1]++} END {for(k in count) print k,count[k]}'")]),t._v(" 统计")]),t._v(" "),a("li",[a("code",[t._v("cat <file> | awk -F ',' '{ sum += $7; if (min == \"\") min = max = $7; if ($7 > max) max = $7; if ($7 < min) min = $7 } END { print max, sum/NR, min }'")]),t._v(" 计算最大值、最小值、平均值")])]),t._v(" "),a("h3",{attrs:{id:"grep"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#grep"}},[t._v("#")]),t._v(" grep")]),t._v(" "),a("ul",[a("li",[a("code",[t._v('grep -v "match_pattern" <file>')]),t._v(" 输出除了什么之外")]),t._v(" "),a("li",[a("code",[t._v('grep -c "match_pattern" <file>')]),t._v(" 输出包含字符行数")]),t._v(" "),a("li",[a("code",[t._v('grep "match_pattern" . -r -n')]),t._v(" 递归搜索文件")]),t._v(" "),a("li",[a("code",[t._v('grep -E "pattern1|pattern2" <file>')]),t._v(" 匹配多个样式")]),t._v(" "),a("li",[a("code",[t._v("grep -F -v -f a.file b.file")]),t._v(" 查询b-a差集")])]),t._v(" "),a("h3",{attrs:{id:"find"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#find"}},[t._v("#")]),t._v(" find")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("find . -type f -atime -7")]),t._v(" 最近7天内被访问过的文件")]),t._v(" "),a("li",[a("code",[t._v("find . -type f -atime 7")]),t._v("  7天前被访问过的文件")]),t._v(" "),a("li",[a("code",[t._v("find . -type f -atime +7")]),t._v(" 超过7天内被访问的文件")]),t._v(" "),a("li",[a("code",[t._v('find . -type f -name "*.txt" -delete')]),t._v(" 删除当前目录*.txt")]),t._v(" "),a("li",[a("code",[t._v('find . -name "*.txt" -o -name "*.pdf"')]),t._v(" 获取多种后缀名文件")])]),t._v(" "),a("h3",{attrs:{id:"sort"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sort"}},[t._v("#")]),t._v(" sort")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("cat <file> | sort -t ',' -k 2 -rn")]),t._v(" 文件逗号分隔，按照第2列纯数字逆序排序输出")])]),t._v(" "),a("h3",{attrs:{id:"sed"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sed"}},[t._v("#")]),t._v(" sed")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("sed '/^$/d' <file>")]),t._v(" 删除空白行")]),t._v(" "),a("li",[a("code",[t._v("sed '2d' <file>")]),t._v(" 删除文件第2行")]),t._v(" "),a("li",[a("code",[t._v("sed '2,$d' file")]),t._v(" 删除文件第2到末尾所有行")]),t._v(" "),a("li",[a("code",[t._v("sed '$d' file")]),t._v(" 删除文件最后一行")]),t._v(" "),a("li",[a("code",[t._v("sed 's/book/books/g' <file>")]),t._v(" 替换文件的所有字符串")]),t._v(" "),a("li",[a("code",[t._v("sed 's/book/books/2g' <file>")]),t._v(" 从第N处匹配开始替换时替换文件的所有字符串")]),t._v(" "),a("li",[a("code",[t._v("sed 's/,/\\n/g' <file>")]),t._v(" 替换换行符")]),t._v(" "),a("li",[a("code",[t._v("sed -i '1i\\<content>' <file>")]),t._v(" 第1行插入")]),t._v(" "),a("li",[a("code",[t._v("sed -i '/^INFO/'d <file>")]),t._v(" 删除以INFO开头的文件")])]),t._v(" "),a("h3",{attrs:{id:"ls"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ls"}},[t._v("#")]),t._v(" ls")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("ls station_[0-9a-z]*_orders.txt")]),t._v(" 查看文件")]),t._v(" "),a("li",[a("code",[t._v('ls -l | grep "^d"')]),t._v(" 只查看文件夹")])]),t._v(" "),a("h3",{attrs:{id:"uniq"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#uniq"}},[t._v("#")]),t._v(" uniq")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("cat <file1> <file2> | sort | uniq -u")]),t._v(" 求文本差集")]),t._v(" "),a("li",[a("code",[t._v("sort <file> | uniq -c")]),t._v(" 计算行重复的次数")]),t._v(" "),a("li",[a("code",[t._v("sort <file> | uniq -d")]),t._v(" 仅显示重复行")]),t._v(" "),a("li",[a("code",[t._v("sort <file> | uniq -u")]),t._v(" 仅显示不重复行")])]),t._v(" "),a("h3",{attrs:{id:"tr"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tr"}},[t._v("#")]),t._v(" tr")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("cat <file> | tr a-z A-Z")]),t._v(" 小写转大写")]),t._v(" "),a("li",[a("code",[t._v('cat <file> | tr "," "\\t"')]),t._v(" 逗号分隔符转tab")])]),t._v(" "),a("h3",{attrs:{id:"cut"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cut"}},[t._v("#")]),t._v(" cut")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("echo $PATH | cut -d ':' -f 3,5")]),t._v(" 提取第3和第5列")])]),t._v(" "),a("h3",{attrs:{id:"wc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#wc"}},[t._v("#")]),t._v(" wc")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("wc -l")]),t._v(" 计算行数")]),t._v(" "),a("li",[a("code",[t._v("wc -w")]),t._v(" 计算单词数")]),t._v(" "),a("li",[a("code",[t._v("wc -m")]),t._v(" 计算字节数")])]),t._v(" "),a("h3",{attrs:{id:"zip"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zip"}},[t._v("#")]),t._v(" zip")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("zip -r <file>.zip <file>")])]),t._v(" "),a("li",[a("code",[t._v("unzip <file>.zip")])])]),t._v(" "),a("h3",{attrs:{id:"tar"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tar"}},[t._v("#")]),t._v(" tar")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("tar -czvf file.gz <file>")]),t._v(" 压缩")]),t._v(" "),a("li",[a("code",[t._v("tar --exclude=<dir>/1.txt -czvf file.gz <dir>")]),t._v(" 排除文件排除1.txt压缩")]),t._v(" "),a("li",[a("code",[t._v("tar -tzvf file.gz")]),t._v(" 列出压缩文件列表")]),t._v(" "),a("li",[a("code",[t._v("tar -xzvf file.gz")]),t._v(" 解压")])]),t._v(" "),a("h3",{attrs:{id:"rsync"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rsync"}},[t._v("#")]),t._v(" rsync")]),t._v(" "),a("p",[t._v("需要复制本机ssh公钥到远程机器")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("cat ~/.ssh/id_rsa.pub >> authorized_keys\n")])])]),a("ul",[a("li",[a("code",[t._v("rsync --bwlimit=10000 -artP <file> -e 'ssh -p <port>' root@<ip>:<target_path>")]),t._v(" 从本地传输文件到远程机器")]),t._v(" "),a("li",[a("code",[t._v("rsync --bwlimit=10000 -artP -e 'ssh -p <port>' root@<ip>:<source_path> ./")]),t._v(" 从远程机器拉取文件到本地")])]),t._v(" "),a("h2",{attrs:{id:"系统状态"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#系统状态"}},[t._v("#")]),t._v(" 系统状态")]),t._v(" "),a("h3",{attrs:{id:"负载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#负载"}},[t._v("#")]),t._v(" 负载")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("top")])]),t._v(" "),a("li",[a("code",[t._v("uptime")])])]),t._v(" "),a("h3",{attrs:{id:"cpu"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cpu"}},[t._v("#")]),t._v(" CPU")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("mpstat -P ALL")]),t._v(" cpu各核使用率")])]),t._v(" "),a("h3",{attrs:{id:"内存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#内存"}},[t._v("#")]),t._v(" 内存")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("vmstat")])]),t._v(" "),a("li",[a("code",[t._v("free")])])]),t._v(" "),a("h3",{attrs:{id:"网络"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#网络"}},[t._v("#")]),t._v(" 网络")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("ss")])]),t._v(" "),a("li",[a("code",[t._v("ifstat")]),t._v(" 网络io统计")]),t._v(" "),a("li",[a("code",[t._v("netstat -nat | grep <port>")]),t._v(" 指定端口的网络连接数")]),t._v(" "),a("li",[a("code",[t._v("netstat -nat|awk '{print $6}'|sort|uniq -c|sort -rn")]),t._v(" 网络连接各状态统计")])]),t._v(" "),a("h3",{attrs:{id:"磁盘"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#磁盘"}},[t._v("#")]),t._v(" 磁盘")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("iostat")]),t._v(" 磁盘io统计")]),t._v(" "),a("li",[a("code",[t._v("iotop -o")]),t._v(" 磁盘io占用top")]),t._v(" "),a("li",[a("code",[t._v("du -sh ./* | sort -rn | head -n 10")]),t._v(" 磁盘空间占用top10的文件")])]),t._v(" "),a("h3",{attrs:{id:"进程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#进程"}},[t._v("#")]),t._v(" 进程")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("pidstat")])]),t._v(" "),a("li",[a("code",[t._v("ps aux head -1; ps aux | sort -rn -k3 | head -n 10")]),t._v(" cpu占用top10的进程")]),t._v(" "),a("li",[a("code",[t._v("ps aux head -1; ps aux | sort -rn -k4 | head -n 10")]),t._v(" 内存占用top10的进程")]),t._v(" "),a("li",[a("code",[t._v("pidstat -d <时间间隔> -p <进程id>")]),t._v(" 进程占用磁盘io")]),t._v(" "),a("li",[a("code",[t._v("iftop")])]),t._v(" "),a("li",[a("code",[t._v("nethogs")]),t._v(" 进程带宽")])]),t._v(" "),a("h3",{attrs:{id:"线程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#线程"}},[t._v("#")]),t._v(" 线程")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("ps hH p | grep <pid>")]),t._v(" 查看进程的线程")])]),t._v(" "),a("h2",{attrs:{id:"系统监控"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#系统监控"}},[t._v("#")]),t._v(" 系统监控")]),t._v(" "),a("h3",{attrs:{id:"进程内存监控"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#进程内存监控"}},[t._v("#")]),t._v(" 进程内存监控")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("# !/bin/sh\n# 内存是$4，cpu是$3，$2是进程号，内存>5%\npids=ps aux | grep <progress> | grep -v grep | awk '{if($4>=5)print $2}' \nfor pid in pids; \n   do kill -9 $pid echo date +'%F %T' $pid >>/var/log/kill.log \ndone\n")])])]),a("h3",{attrs:{id:"网络带宽监控"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#网络带宽监控"}},[t._v("#")]),t._v(" 网络带宽监控")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("\n")])])]),a("h3",{attrs:{id:"磁盘空间监控"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#磁盘空间监控"}},[t._v("#")]),t._v(" 磁盘空间监控")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('#!/bin/sh \n\ndiskinfo="/tmp/diskinfo.txt"\nfor d in `df -P | grep /dev | awk \'{print $5}\'| sed \'s/%//g\'`\ndo\n    if [ $d -gt 90 ];then\n        df -h>>$diskinfo;\n        #sendmail\n        mutt -s "disk warining!" "1399534656@qq.com" <${diskinfo} -a ${diskinfo}\n        exit 0;\n    fi\ndone\n')])])]),a("h2",{attrs:{id:"性能排查"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#性能排查"}},[t._v("#")]),t._v(" 性能排查")]),t._v(" "),a("p",[t._v("排查引起系统变慢/网络超时的原因")]),t._v(" "),a("h3",{attrs:{id:"cpu高"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cpu高"}},[t._v("#")]),t._v(" cpu高")]),t._v(" "),a("h3",{attrs:{id:"内存高"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#内存高"}},[t._v("#")]),t._v(" 内存高")]),t._v(" "),a("h3",{attrs:{id:"网络带宽高"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#网络带宽高"}},[t._v("#")]),t._v(" 网络带宽高")]),t._v(" "),a("h3",{attrs:{id:"磁盘io高"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#磁盘io高"}},[t._v("#")]),t._v(" 磁盘IO高")]),t._v(" "),a("h3",{attrs:{id:"gc耗时高"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gc耗时高"}},[t._v("#")]),t._v(" GC耗时高")])])}),[],!1,null,null,null);a.default=_.exports}}]);