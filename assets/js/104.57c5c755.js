(window.webpackJsonp=window.webpackJsonp||[]).push([[104],{395:function(t,a,e){"use strict";e.r(a);var s=e(14),r=Object(s.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("blockquote",[a("p",[t._v("<<从0开始学架构>> 学习笔记Day05：高性能架构模式-读写分离")])]),t._v(" "),a("h1",{attrs:{id:"读写分离原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#读写分离原理"}},[t._v("#")]),t._v(" 读写分离原理")]),t._v(" "),a("p",[t._v("读写分离的基本原理是将数据库读写操作分散到不同的节点上，分散访问压力")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://static001.geekbang.org/resource/image/36/07/362d22168bf344687ec0c206aa115807.jpg?wh=2744*1943",alt:""}})]),t._v(" "),a("p",[t._v("读写分离的基本实现是：数据库服务器搭建主从集群，一主一从、一主多从都可以。数据库主机负责读写操作，从机只负责读操作。数据库主机通过复制将数据同步到从机，每台数据库服务器都存储了所有的业务数据。业务服务器将写操作发给数据库主机，将读操作发给数据库从机。")]),t._v(" "),a("p",[t._v("读写分离的实现逻辑并不复杂，但有两个细节点将引入设计复杂度：主从复制延迟和分配机制。")]),t._v(" "),a("h1",{attrs:{id:"复制延迟"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#复制延迟"}},[t._v("#")]),t._v(" 复制延迟")]),t._v(" "),a("p",[t._v("解决主从复制延迟有几种常见的方法：")]),t._v(" "),a("ol",[a("li",[t._v("写操作后的读操作指定发给数据库主服务器")]),t._v(" "),a("li",[t._v("读从机失败后再读一次主机")]),t._v(" "),a("li",[t._v("关键业务读写操作全部指向主机，非关键业务采用读写分离")])]),t._v(" "),a("h1",{attrs:{id:"分配机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#分配机制"}},[t._v("#")]),t._v(" 分配机制")]),t._v(" "),a("p",[t._v("将读写操作区分开来，然后访问不同的数据库服务器，一般有两种方式：程序代码封装和中间件封装。")]),t._v(" "),a("ol",[a("li",[t._v("程序代码封装")])]),t._v(" "),a("p",[t._v("优点：实现简单，而且可以根据业务做较多定制化的功能")]),t._v(" "),a("p",[t._v("缺点：故障情况下，如果主从发生切换，则可能需要所有系统都修改配置并重启")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://static001.geekbang.org/resource/image/f8/df/f8d538f9201e3ebee37dfdcd1922e9df.jpg?wh=2661*2178",alt:""}})]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[t._v("中间件封装")])]),t._v(" "),a("p",[t._v("优点：数据库主从切换对业务服务器无感知，数据库中间件可以探测数据库服务器的主从状态")]),t._v(" "),a("p",[t._v("缺点：数据库中间件要支持完整的 SQL 语法和数据库服务器的协议（例如，MySQL 客户端和服务器的连接协议），实现比较复")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://static001.geekbang.org/resource/image/2a/8e/2a2dba7f07581fd055d9cd5a3aa8388e.jpg?wh=2918*1905",alt:""}})])])}),[],!1,null,null,null);a.default=r.exports}}]);